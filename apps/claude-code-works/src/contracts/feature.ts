/**
 * Feature contracts - pure types for improvement features.
 *
 * A Feature represents an improvement opportunity discovered by the Initializer
 * and worked on by the Coding Agent.
 */

/**
 * Categories of improvement based on the three metrics dimensions.
 */
export type FeatureCategory = 'quality' | 'performance' | 'behavior';

/**
 * Impact level for prioritization.
 */
export type FeatureImpact = 'high' | 'medium' | 'low';

/**
 * Status of a feature in the improvement cycle.
 */
export type FeatureStatus = 'pending' | 'in_progress' | 'completed' | 'blocked';

/**
 * A single improvement feature.
 *
 * @example
 * ```typescript
 * const feature: Feature = {
 *   id: 'F001',
 *   category: 'quality',
 *   title: 'Fix lint violations in port-logger',
 *   description: '3 biome lint violations in packages/port-logger/src',
 *   impact: 'low',
 *   files: ['packages/port-logger/src/index.ts'],
 *   status: 'pending',
 *   retryCount: 0,
 * };
 * ```
 */
export interface Feature {
  readonly id: string;
  readonly category: FeatureCategory;
  readonly title: string;
  readonly description: string;
  readonly impact: FeatureImpact;
  readonly files: readonly string[];
  readonly status: FeatureStatus;
  /** Number of implementation attempts (incremented on rejection/failure) */
  readonly retryCount: number;
  /** ISO timestamp of last attempt */
  readonly lastAttempt?: string;
  /** Reason if blocked after max retries */
  readonly blockReason?: string;
}

/**
 * Baseline metrics captured at initialization.
 */
export interface MetricsBaseline {
  readonly coverage: number;
  readonly typeErrors: number;
  readonly lintViolations: number;
  readonly testDurationMs: number;
  readonly unusedExports: number;
}

/**
 * The feature list artifact (feature-list.json).
 *
 * Generated by the Initializer agent and consumed by Coding/Reviewer agents.
 * Uses JSON format to prevent inappropriate overwrites (per Anthropic blog).
 */
export interface FeatureList {
  readonly created: string;
  readonly baseline: MetricsBaseline;
  readonly features: readonly Feature[];
}
